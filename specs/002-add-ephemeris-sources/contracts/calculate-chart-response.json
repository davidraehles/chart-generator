{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Chart Calculation Response",
  "description": "Response schema for POST /api/calculate-chart endpoint. Returns complete Human Design chart with planetary activations.",
  "type": "object",
  "required": [
    "personality_activations",
    "design_activations",
    "calculation_source",
    "calculated_at"
  ],
  "properties": {
    "name": {
      "type": "string",
      "description": "User's name if provided in request",
      "example": "Max Mustermann"
    },
    "personality_activations": {
      "type": "array",
      "description": "13 activations from birth moment (Personality chart)",
      "minItems": 13,
      "maxItems": 13,
      "items": {
        "$ref": "#/definitions/HDActivation"
      }
    },
    "design_activations": {
      "type": "array",
      "description": "13 activations from 88° before birth (Design chart)",
      "minItems": 13,
      "maxItems": 13,
      "items": {
        "$ref": "#/definitions/HDActivation"
      }
    },
    "type": {
      "type": ["string", "null"],
      "description": "HD Type (Phase 2+ - currently null)",
      "enum": [null, "Generator", "Manifesting Generator", "Projector", "Manifestor", "Reflector"],
      "example": null
    },
    "authority": {
      "type": ["string", "null"],
      "description": "Decision authority (Phase 2+ - currently null)",
      "example": null
    },
    "profile": {
      "type": ["string", "null"],
      "description": "Profile (e.g., '1/3', '6/2') (Phase 2+ - currently null)",
      "pattern": "^[1-6]/[1-6]$",
      "example": null
    },
    "calculation_source": {
      "type": "string",
      "description": "Ephemeris source used for calculations",
      "enum": ["SwissEphemeris", "OpenAstroAPI", "NASAJPLHorizons"],
      "example": "SwissEphemeris"
    },
    "calculated_at": {
      "type": "string",
      "format": "date-time",
      "description": "UTC timestamp when calculation was performed",
      "example": "2025-11-24T20:00:00Z"
    }
  },
  "definitions": {
    "HDActivation": {
      "type": "object",
      "description": "Single Human Design activation (planetary position mapped to gate and line)",
      "required": ["body", "gate", "line", "ecliptic_degree", "chart_type"],
      "properties": {
        "body": {
          "type": "string",
          "description": "Celestial body",
          "enum": [
            "Sun",
            "Moon",
            "Mercury",
            "Venus",
            "Mars",
            "Jupiter",
            "Saturn",
            "Uranus",
            "Neptune",
            "Pluto",
            "North Node",
            "South Node",
            "Chiron"
          ],
          "example": "Sun"
        },
        "gate": {
          "type": "integer",
          "description": "HD Gate number (1-64, corresponds to I'Ching hexagram)",
          "minimum": 1,
          "maximum": 64,
          "example": 27
        },
        "line": {
          "type": "integer",
          "description": "Line number within the gate (1-6)",
          "minimum": 1,
          "maximum": 6,
          "example": 3
        },
        "ecliptic_degree": {
          "type": "number",
          "description": "Source ecliptic longitude in degrees (0-360)",
          "minimum": 0,
          "exclusiveMaximum": 360,
          "example": 85.234
        },
        "chart_type": {
          "type": "string",
          "description": "Whether this is Personality (birth) or Design (88° before) activation",
          "enum": ["personality", "design"],
          "example": "personality"
        }
      }
    }
  },
  "examples": [
    {
      "name": "Max Mustermann",
      "personality_activations": [
        {
          "body": "Sun",
          "gate": 27,
          "line": 3,
          "ecliptic_degree": 85.234,
          "chart_type": "personality"
        },
        {
          "body": "Moon",
          "gate": 12,
          "line": 5,
          "ecliptic_degree": 201.450,
          "chart_type": "personality"
        },
        {
          "body": "Mercury",
          "gate": 3,
          "line": 1,
          "ecliptic_degree": 95.123,
          "chart_type": "personality"
        },
        {
          "body": "Venus",
          "gate": 22,
          "line": 4,
          "ecliptic_degree": 47.890,
          "chart_type": "personality"
        },
        {
          "body": "Mars",
          "gate": 51,
          "line": 2,
          "ecliptic_degree": 78.567,
          "chart_type": "personality"
        },
        {
          "body": "Jupiter",
          "gate": 32,
          "line": 6,
          "ecliptic_degree": 265.432,
          "chart_type": "personality"
        },
        {
          "body": "Saturn",
          "gate": 7,
          "line": 1,
          "ecliptic_degree": 191.234,
          "chart_type": "personality"
        },
        {
          "body": "Uranus",
          "gate": 18,
          "line": 4,
          "ecliptic_degree": 244.678,
          "chart_type": "personality"
        },
        {
          "body": "Neptune",
          "gate": 36,
          "line": 3,
          "ecliptic_degree": 277.890,
          "chart_type": "personality"
        },
        {
          "body": "Pluto",
          "gate": 60,
          "line": 5,
          "ecliptic_degree": 213.456,
          "chart_type": "personality"
        },
        {
          "body": "North Node",
          "gate": 13,
          "line": 2,
          "ecliptic_degree": 66.789,
          "chart_type": "personality"
        },
        {
          "body": "South Node",
          "gate": 7,
          "line": 2,
          "ecliptic_degree": 246.789,
          "chart_type": "personality"
        },
        {
          "body": "Chiron",
          "gate": 25,
          "line": 4,
          "ecliptic_degree": 143.210,
          "chart_type": "personality"
        }
      ],
      "design_activations": [
        {
          "body": "Sun",
          "gate": 3,
          "line": 5,
          "ecliptic_degree": 17.890,
          "chart_type": "design"
        },
        {
          "body": "Moon",
          "gate": 44,
          "line": 2,
          "ecliptic_degree": 284.567,
          "chart_type": "design"
        },
        {
          "body": "Mercury",
          "gate": 27,
          "line": 1,
          "ecliptic_degree": 87.123,
          "chart_type": "design"
        },
        {
          "body": "Venus",
          "gate": 22,
          "line": 3,
          "ecliptic_degree": 46.234,
          "chart_type": "design"
        },
        {
          "body": "Mars",
          "gate": 51,
          "line": 1,
          "ecliptic_degree": 77.890,
          "chart_type": "design"
        },
        {
          "body": "Jupiter",
          "gate": 32,
          "line": 5,
          "ecliptic_degree": 264.567,
          "chart_type": "design"
        },
        {
          "body": "Saturn",
          "gate": 7,
          "line": 1,
          "ecliptic_degree": 191.123,
          "chart_type": "design"
        },
        {
          "body": "Uranus",
          "gate": 18,
          "line": 4,
          "ecliptic_degree": 244.456,
          "chart_type": "design"
        },
        {
          "body": "Neptune",
          "gate": 36,
          "line": 3,
          "ecliptic_degree": 277.789,
          "chart_type": "design"
        },
        {
          "body": "Pluto",
          "gate": 60,
          "line": 5,
          "ecliptic_degree": 213.345,
          "chart_type": "design"
        },
        {
          "body": "North Node",
          "gate": 13,
          "line": 2,
          "ecliptic_degree": 66.678,
          "chart_type": "design"
        },
        {
          "body": "South Node",
          "gate": 7,
          "line": 2,
          "ecliptic_degree": 246.678,
          "chart_type": "design"
        },
        {
          "body": "Chiron",
          "gate": 25,
          "line": 4,
          "ecliptic_degree": 143.123,
          "chart_type": "design"
        }
      ],
      "type": null,
      "authority": null,
      "profile": null,
      "calculation_source": "SwissEphemeris",
      "calculated_at": "2025-11-24T20:00:00Z"
    }
  ]
}
